<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${transport.name} + ' - Book'">Detail Transport</title>
</head>
<body>
    <th:block th:replace="~{fragment/user-layout :: layout(title=${transport.name}, content=~{::content})}">
        <div th:fragment="content">
            
            <div class="relative w-full h-[60vh] group">
                
                <a th:href="@{/}" 
                   class="absolute top-6 left-6 md:left-12 z-30 w-12 h-12 rounded-full flex items-center justify-center transition-all duration-300 
                          bg-brand-dark/60 border-2 border-purple-500 text-purple-500 
                          shadow-[0_0_15px_rgba(168,85,247,0.3)] backdrop-blur-md
                          hover:bg-purple-500 hover:text-white hover:scale-110 hover:shadow-[0_0_25px_rgba(168,85,247,0.6)]" 
                   title="Kembali ke Beranda">
                    <i class="ri-arrow-left-line text-xl font-bold"></i>
                </a>
                <img th:if="${transport.image != null}" th:src="@{${transport.imagePath}}" class="w-full h-full object-cover" data-speed="0.5">
                <img th:unless="${transport.image != null}" src="https://source.unsplash.com/random/1600x900/?airplane,train,bus" class="w-full h-full object-cover" data-speed="0.5">
                <div class="absolute inset-0 bg-gradient-to-b from-transparent via-brand-dark/50 to-brand-dark"></div>
                
                <div class="absolute bottom-0 left-0 w-full p-6 md:p-12 z-10">
                    <div class="container mx-auto">
                         <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-purple-500/30 bg-purple-500/10 backdrop-blur-md text-purple-400 text-xs mb-4 uppercase tracking-widest font-bold">
                             <i class="ri-steering-2-line"></i> <span th:text="${transport.provider.type}">Type</span>
                         </div>
                        <h1 class="text-5xl md:text-7xl font-serif italic text-white mb-2" th:text="${transport.name}">Transport Name</h1>
                        <p class="text-xl text-gray-300 flex items-center gap-2">
                            <i class="ri-building-4-line text-brand-accent"></i> <span th:text="${transport.provider.name}">Provider</span>
                        </p>
                    </div>
                </div>
            </div>

            <div class="container mx-auto px-6 py-12 relative z-20 -mt-20">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                    
                    <div class="lg:col-span-2 space-y-10">
                        <div class="glass-panel p-8 rounded-3xl border border-white/5 shadow-2xl shadow-brand-dark/50">
                            <h2 class="text-2xl font-bold text-white mb-4">Travel in Comfort</h2>
                            <p class="text-gray-400 leading-relaxed text-lg">
                                Perjalanan jarak jauh terasa singkat bersama <span class="text-brand-accent font-semibold" th:text="${transport.name}"></span>. 
                                Armada kami dilengkapi dengan teknologi terkini untuk memastikan keselamatan dan kenyamanan maksimal Anda. 
                                Duduk, rileks, dan biarkan kami membawa Anda ke tujuan.
                            </p>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="glass-panel p-5 rounded-2xl flex flex-col items-center justify-center text-center gap-3 hover:bg-white/5 transition group border border-white/5">
                                <div class="w-12 h-12 rounded-full bg-purple-500/10 flex items-center justify-center text-purple-400 group-hover:scale-110 transition-transform">
                                    <i class="ri-armchair-line text-2xl"></i>
                                </div>
                                <span class="text-sm text-gray-300 font-medium">Reclining Seats</span>
                            </div>
                            <div class="glass-panel p-5 rounded-2xl flex flex-col items-center justify-center text-center gap-3 hover:bg-white/5 transition group border border-white/5">
                                <div class="w-12 h-12 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-400 group-hover:scale-110 transition-transform">
                                    <i class="ri-temp-cold-line text-2xl"></i>
                                </div>
                                <span class="text-sm text-gray-300 font-medium">Climate Control</span>
                            </div>
                            <div class="glass-panel p-5 rounded-2xl flex flex-col items-center justify-center text-center gap-3 hover:bg-white/5 transition group border border-white/5">
                                <div class="w-12 h-12 rounded-full bg-red-500/10 flex items-center justify-center text-red-400 group-hover:scale-110 transition-transform">
                                    <i class="ri-movie-line text-2xl"></i>
                                </div>
                                <span class="text-sm text-gray-300 font-medium">Entertainment</span>
                            </div>
                            <div class="glass-panel p-5 rounded-2xl flex flex-col items-center justify-center text-center gap-3 hover:bg-white/5 transition group border border-white/5">
                                <div class="w-12 h-12 rounded-full bg-yellow-500/10 flex items-center justify-center text-yellow-400 group-hover:scale-110 transition-transform">
                                    <i class="ri-battery-charge-line text-2xl"></i>
                                </div>
                                <span class="text-sm text-gray-300 font-medium">USB Charging</span>
                            </div>
                        </div>
                    </div>

                    <div class="lg:col-span-1">
                        <div class="sticky top-28 glass-panel p-8 rounded-3xl border-t border-brand-accent/50 shadow-2xl shadow-brand-accent/5 bg-brand-surface/40 backdrop-blur-xl">
                            <h3 class="text-2xl font-serif italic text-white mb-6">Select Departure</h3>
                            
                            <form th:action="@{/order/create}" method="post" class="space-y-6">
                                <input type="hidden" name="itemType" value="Transport" />
                                <input type="hidden" id="selectedItemId" name="itemId" th:value="${tickets != null and !tickets.isEmpty() ? tickets[0].ticketId : ''}" />

                                <div th:if="${tickets != null && !tickets.isEmpty()}">
                                    <div class="space-y-2">
                                        <label class="text-xs uppercase tracking-wider text-gray-500 font-bold">Schedule</label>
                                        <div class="relative">
                                            <select id="ticketSelect" onchange="updatePrice()" class="w-full bg-brand-dark/50 border border-white/10 text-white rounded-xl p-4 appearance-none focus:border-purple-500 focus:ring-0 outline-none cursor-pointer transition-colors hover:bg-brand-dark/70">
                                                <option th:each="t : ${tickets}" 
                                                        th:value="${t.ticketId}" 
                                                        th:data-price="${t.price}"
                                                        th:text="${#dates.format(t.departureDate, 'dd MMM yyyy')} + ' - Seat Available'">
                                                    Date
                                                </option>
                                            </select>
                                            <i class="ri-time-line absolute right-4 top-4 text-purple-500 pointer-events-none"></i>
                                        </div>
                                    </div>

                                    <div class="space-y-2 mt-4">
                                        <label class="text-xs uppercase tracking-wider text-gray-500 font-bold">Passengers</label>
                                        <div class="flex items-center bg-brand-dark/50 border border-white/10 rounded-xl p-2">
                                            <button type="button" onclick="adjustQty(-1)" class="w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 text-white transition-colors"><i class="ri-subtract-line"></i></button>
                                            <input type="number" id="qtyInput" name="quantity" value="1" min="1" class="bg-transparent border-none text-center text-white font-bold w-full focus:ring-0 appearance-none">
                                            <button type="button" onclick="adjustQty(1)" class="w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 text-white transition-colors"><i class="ri-add-line"></i></button>
                                        </div>
                                    </div>

                                    <div class="py-6 border-b border-white/10 flex justify-between items-end">
                                        <span class="text-gray-400 text-sm">Total Fare</span>
                                        <span id="displayPrice" class="text-3xl font-bold text-purple-400" th:text="'Rp ' + ${#numbers.formatDecimal(tickets[0].price, 0, 'POINT', 0, 'COMMA')}">Rp 0</span>
                                    </div>

                                    <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 rounded-xl transition-all transform hover:scale-[1.02] flex items-center justify-center gap-2 mt-4 shadow-lg shadow-purple-900/20">
                                        <span>Book Seat</span>
                                        <i class="ri-plane-fill"></i>
                                    </button>
                                </div>
                                
                                <div th:unless="${tickets != null && !tickets.isEmpty()}" class="text-center py-8">
                                    <div class="w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-500">
                                        <i class="ri-calendar-close-line text-2xl"></i>
                                    </div>
                                    <p class="text-gray-500">Jadwal belum tersedia.</p>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
            </div>

            <script>
                function updatePrice() {
                    const select = document.getElementById('ticketSelect');
                    const selectedOption = select.options[select.selectedIndex];
                    const price = selectedOption.getAttribute('data-price');
                    document.getElementById('selectedItemId').value = selectedOption.value;
                    
                    const formatter = new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 });
                    document.getElementById('displayPrice').innerText = formatter.format(price);
                }

                function adjustQty(amount) {
                    const input = document.getElementById('qtyInput');
                    let val = parseInt(input.value) + amount;
                    if(val < 1) val = 1;
                    input.value = val;
                }
            </script>
        </div>
    </th:block>
</body>
</html>